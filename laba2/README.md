# Лабораторная работа №1 - Отчет
## Теоретическая часть
Классификация звука - присваивает метку класса аудио на основе из входных данных - необработанных звуковыъ сигналов.
Некоторые практические применения классификации звуков включают определение намерений говорящего, языковую классификацию и даже виды животных по их звукам.

Facebook's Wav2Vec2 - базовая модель предварительно обучалась на сэмплированном звуке речи частотой 16 кГц. 
Она маскирует скрытые представления необработанной формы сигнала и решает контрастную задачу по сравнению с квантованными речевыми
представлениями. Эксперименты показывают большой потенциал предварительной подготовки на немаркированных данных для
обработки речи. Модель достигает результатов, которые соответствуют новому уровню техники в полном тесте Librispeech для
шумной речи. При чистой 100-часовой настройке Librispeech wav2vec 2.0 превосходит предыдущий лучший
результат, используя в 100 раз меньше помеченных данных. Этот подход также эффективен при наличии больших объемов
помеченных данных. Также имеется повышение производительности за счет перехода на архитектуру seq2seq и
словарный запас word piece. [1]

Архитектура окончательной модели, используемой для прогнозирования, состоит из трех основных частей: [2]
1. Cверточные слои, которые обрабатывают исходную форму сигнала для получения скрытого представления - Z
2. Cлои-трансформеры, создающие контекстуализированное представление - C
3. Линейная проекция на вывод - Y

![image](https://user-images.githubusercontent.com/91135334/209224611-72f6f8be-c4c4-4e69-bb2c-bc41a14c334f.png)

Основная идея предварительной подготовки аналогична BERT: часть входных данных преобразователя замаскирована, и цель состоит в том, чтобы угадать замаскированное представление вектора скрытых признаков Zₜ. Однако авторы усовершенствовали эту простую идею с помощью контрастивного обучения.

## Задание 1. 

### Задача
Согласно варианту выбрать предварительнообученную модель и на основе Audio Embeddings (Wav2Vec2) датасета Youtube Videos Dataset дообучить ее для задачи классификации. Оценить качество модели.

### Код
`lab2-part1.ipynb` - data downloading

`lab2-part2.ipynb` - fine-tunning model
### Разработанная система

C помощью кода lab2-part1.ipynb была выкачана половина датасета [3],  был выгружен не весь датасет, поскольку это слишком долго, так как имеются видео, длящиеся более 11 часов. Среди этой половины датасета, не все данные получилось прочитать, так как многие видео уже недоступны. Также данные сильно несбалансированы, так было получего:
* history - 109 
* art_music - 109
* travel -181
* food - 145

Было решено просто взять по 109 семплов из каждого класса, 11 на valid и 98 на train

![загруженное (1)](https://user-images.githubusercontent.com/91135334/209225920-03c13b0f-98d5-49e9-952a-637819d94231.png)

После того как были загружены данные, скачанные в файле lab2-part1.ipynb, был начат препроцессинг данных и дальнешая тонкая настройка. 
Для  разработки использовалить в основном такие библиотеки, как - transformers, datasets, pandas, numpy.

Был загружен Wav2Vec2 feature extractor для обработки аудиосигнала. Была выбрана именная эта модель по той причине, что она дает отличную производительность без больших объемов данных. Далее была создана функция предварительной обработки.

Далее была загружена модель facebook/wav2vec2-base на 4 класса и прописаны параметры для дальнейшего обучения. 


### Результаты

Результаты обучения представлены ниже:

### Выводы

Таким образом, была обучена модель для классификации видео из  YouTube на основе аудиоэмбендингов, метрика  accuracy показала наилучшее значение - XX, что лучше наивного алгоритма (25%), который выбирал бы самый частый класс на XX%.
Можно добиться лучшего результа, если увеличить набор данных или попробовать модели с большим количеством параметров или другими гиперпараметрами. 

## Использованные источники

[1] https://arxiv.org/pdf/2006.11477.pdf

[2] https://towardsdatascience.com/wav2vec-2-0-a-framework-for-self-supervised-learning-of-speech-representations-7d3728688cae

[3] https://www.kaggle.com/datasets/rajatrc1705/youtube-videos-dataset
